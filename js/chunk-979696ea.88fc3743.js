(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-979696ea","chunk-2d0bd9d8"],{"2d6f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-image",{staticStyle:{width:"200px",height:"75px"},attrs:{src:e.scope.row.imageUrl}})},o=[],i={props:{value:{type:Boolean,require:!0},scope:{default:null},myProps:{default:null}},computed:{},mounted:function(){},methods:{}},r=i,l=a("2877"),s=function(e){e.options.__source="src/views/index/components/IndexBannerImage.vue"},c=s,d=Object(l["a"])(r,n,o,!1,null,null,null);"function"===typeof c&&c(d);t["default"]=d.exports},"617e":function(e,t,a){},a6c3:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[a("el-button",{attrs:{type:"success"},on:{click:e.showAddBanner}},[e._v("新增banner")])],1),a("div",[a("d2-crud",{ref:"d2Crud",attrs:{columns:e.columns,data:e.data,loading:e.loading,pagination:e.pagination,rowHandle:e.rowHandle},on:{"custom-emit-1":e.showEditBanner,"row-remove":e.removeBanner,"pagination-current-change":e.paginationCurrentChange}})],1),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.addOrUpdateVisible},on:{"update:visible":function(t){e.addOrUpdateVisible=t}}},[a("el-form",{ref:"indexBannerForm",attrs:{model:e.form,"label-position":"top",rules:e.rules}},[a("el-form-item",{attrs:{label:"banner：",prop:"imageUrl"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://www.weselfshop.cn/enroll-manager/manager/file/file/upload/multipart","show-file-list":!1,headers:e.tokenHeaders,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.form.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"序号（序号越小越靠前）：",prop:"seq"}},[a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.seq,callback:function(t){e.$set(e.form,"seq",t)},expression:"form.seq"}})],1)],1),a("el-form-item",{attrs:{label:"跳转类型："}},[a("el-radio",{attrs:{label:1},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("活动")]),a("el-radio",{attrs:{label:2},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("网页")])],1),a("el-form-item",{attrs:{label:"活动：",prop:"activityId",rules:1===e.form.type?{required:!0,message:"请选择活动",trigger:"blur"}:null}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择活动",disabled:1!==e.form.type},model:{value:e.form.activityId,callback:function(t){e.$set(e.form,"activityId",t)},expression:"form.activityId"}},e._l(e.activityList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"网页地址：",prop:"webUrl",rules:2===e.form.type?{required:!0,message:"请输入网址",trigger:"blur"}:null}},[a("el-col",{attrs:{span:11}},[a("el-input",{attrs:{autocomplete:"off",type:"textarea",rows:3,disabled:2!==e.form.type},model:{value:e.form.webUrl,callback:function(t){e.$set(e.form,"webUrl",t)},expression:"form.webUrl"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addOrUpdateVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveOrUpdate}},[e._v("确 定")])],1)],1)],2)},o=[],i=a("c276"),r=a("ca41"),l=a("9bd2");function s(e){return Object(l["a"])({url:"/manager/index/banner/list",method:"post",headers:{token:i["a"].cookies.get("token")},data:e})}function c(e){return Object(l["a"])({url:"/manager/index/banner/get/"+e,method:"get",headers:{token:i["a"].cookies.get("token")}})}function d(e){return Object(l["a"])({url:"/manager/index/banner/addorupdate",method:"post",headers:{token:i["a"].cookies.get("token")},data:e})}function u(e){return Object(l["a"])({url:"/manager/index/banner/remove/"+e,method:"post",headers:{token:i["a"].cookies.get("token")}})}var m=a("2d6f"),f={name:"index-banner-manager",data:function(){return{dialogTitle:"",addOrUpdateVisible:!1,form:{id:null,imageUrl:"",type:1,activityId:null,webUrl:"",seq:""},rules:{imageUrl:[{required:!0,message:"请上传banner",trigger:"blur"}],seq:[{required:!0,message:"请输入序号",trigger:"blur"}]},tokenHeaders:{token:i["a"].cookies.get("token")},activityList:[],columns:[{title:"banner",key:"imageUrl",component:{name:m["default"]}},{title:"序号",key:"seq"},{title:"跳转类型",key:"type"},{title:"活动标题",key:"activityTitle"},{title:"网页地址",key:"webUrl"}],rowHandle:{custom:[{text:"修改",icon:"el-icon-edit",type:"primary",size:"small",emit:"custom-emit-1"}],remove:{icon:"el-icon-delete",size:"small",fixed:"right",confirm:!0,confirmTitle:"提示",confirmText:"确定删除吗？"}},data:[],options:{stripe:!0},loading:!1,pagination:{currentPage:1,pageSize:5,total:0}}},mounted:function(){this.fetchData(),this.getActivityList()},methods:{paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.loading=!0,s({page:this.pagination.currentPage,limit:this.pagination.pageSize}).then((function(t){console.log(t),e.data=t.list,e.pagination.total=t.total,e.loading=!1})).catch((function(t){console.log("err",t),e.loading=!1}))},showAddBanner:function(){this.form={id:null,imageUrl:"",type:1,activityId:null,webUrl:"",seq:""},this.dialogTitle="新增",this.addOrUpdateVisible=!0},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("只能上传jpg或png格式的图片!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},handleAvatarSuccess:function(e,t){200===e.code?(console.log(e.data),this.form.imageUrl=e.data):this.$message.error("上传失败："+e.desc)},getActivityList:function(){var e=this;Object(r["b"])().then((function(t){e.activityList=t})).catch((function(t){console.log("err",t),e.loading=!1}))},showEditBanner:function(e){var t=this,a=(e.index,e.row),n=a.id;this.dialogTitle="修改",this.addOrUpdateVisible=!0,c(n).then((function(e){t.form=e})).catch((function(e){console.log("err",e),t.loading=!1}))},saveOrUpdate:function(){var e=this;console.log(this.form),this.$refs["indexBannerForm"].validate((function(t){if(!t)return console.log("还有必填信息没有填写"),!1;d(e.form).then((function(t){console.log(t),e.addOrUpdateVisible=!1,e.pagination.currentPage=1,e.fetchData()})).catch((function(t){console.log("err",t),e.loading=!1}))}))},removeBanner:function(e,t){var a=this,n=(e.index,e.row),o=n.id;u(o).then((function(e){a.$message({message:"删除成功",type:"success"}),t()})).catch((function(e){console.log("err",e),a.loading=!1}))}}},p=f,g=(a("e312"),a("2877")),h=function(e){e.options.__source="src/views/index/index-banner-manager.vue"},b=h,v=Object(g["a"])(p,n,o,!1,null,null,null);"function"===typeof b&&b(v);t["default"]=v.exports},ca41:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return c})),a.d(t,"b",(function(){return d}));var n=a("9bd2"),o=a("c276");function i(e){return Object(n["a"])({url:"/manager/activity/activity/list",method:"post",headers:{token:o["a"].cookies.get("token")},data:e})}function r(e){return Object(n["a"])({url:"/manager/activity/activity/add",method:"post",headers:{token:o["a"].cookies.get("token")},data:e})}function l(e){return Object(n["a"])({url:"/manager/activity/activity/get/"+e,method:"get",headers:{token:o["a"].cookies.get("token")}})}function s(e){return Object(n["a"])({url:"/manager/activity/activity/edit",method:"post",headers:{token:o["a"].cookies.get("token")},data:e})}function c(e){return Object(n["a"])({url:"/manager/activity/activity/remove/"+e,method:"post",headers:{token:o["a"].cookies.get("token")}})}function d(){return Object(n["a"])({url:"/manager/activity/activity/all",method:"get",headers:{token:o["a"].cookies.get("token")}})}},e312:function(e,t,a){"use strict";var n=a("617e"),o=a.n(n);o.a}}]);