(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22cd43ad","chunk-2d0b9672"],{"0d23":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("d2-container",[s("template",{slot:"header"},[s("el-row",[s("el-col",{staticStyle:{display:"flex"},attrs:{span:6}},[s("el-input",{attrs:{placeholder:"请输入商家名称..."},model:{value:e.businessName,callback:function(t){e.businessName=t},expression:"businessName"}})],1),s("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.searchList}},[e._v("搜索")]),s("el-button",{attrs:{type:"success"},on:{click:e.addBusiness}},[e._v("新增商家")])],1)],1),s("div",[s("d2-crud",{ref:"d2Crud",attrs:{columns:e.columns,data:e.data,loading:e.loading,pagination:e.pagination,rowHandle:e.rowHandle},on:{"custom-emit-1":e.showEditBusiness,"row-remove":e.removeBusiness,"dialog-cancel":e.handleDialogCancel,"pagination-current-change":e.paginationCurrentChange}})],1),s("el-dialog",{attrs:{title:e.dialogTitle,visible:e.addOrUpdateVisible},on:{"update:visible":function(t){e.addOrUpdateVisible=t}}},[s("el-form",{attrs:{model:e.form,"label-position":"top"}},[s("el-form-item",{attrs:{label:"商家名称：","label-width":"200"}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.businessName,callback:function(t){e.$set(e.form,"businessName",t)},expression:"form.businessName"}})],1),s("el-form-item",{attrs:{label:"商家logo：","label-width":"200"}},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://www.weselfshop.cn/enroll-manager/manager/file/file/upload/multipart","show-file-list":!1,headers:e.tokenHeaders,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.businessLogo?s("img",{staticClass:"avatar",attrs:{src:e.form.businessLogo}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),s("el-form-item",{attrs:{label:"商家介绍：","label-width":"200"}},[s("el-input",{attrs:{autocomplete:"off",type:"textarea",rows:5},model:{value:e.form.businessAbout,callback:function(t){e.$set(e.form,"businessAbout",t)},expression:"form.businessAbout"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.addOrUpdateVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.saveOrUpdate}},[e._v("确 定")])],1)],1)],2)},o=[],i=s("2b6d"),a=s("c276"),r=s("3395"),u={name:"businessList",data:function(){return{businessName:"",form:{id:null,businessName:"",businessLogo:"",businessAbout:""},dialogTitle:"",tokenHeaders:{token:a["a"].cookies.get("token")},columns:[{title:"logo",key:"businessLogo",component:{name:r["default"]}},{title:"名称",key:"businessName"},{title:"创建人",key:"createManagerName"},{title:"创建时间",key:"createTime"}],rowHandle:{custom:[{text:"修改",icon:"el-icon-edit",type:"primary",size:"small",emit:"custom-emit-1"}],remove:{icon:"el-icon-delete",size:"small",fixed:"right",confirm:!0,confirmTitle:"提示",confirmText:"删除后该商家下所有活动将自动删除，确定删除商家？"}},data:[],options:{stripe:!0},loading:!1,pagination:{currentPage:1,pageSize:5,total:0},addOrUpdateVisible:!1}},mounted:function(){this.fetchData()},methods:{paginationCurrentChange:function(e){this.pagination.currentPage=e,this.fetchData()},fetchData:function(){var e=this;this.loading=!0,Object(i["e"])({businessName:this.businessName,page:{page:this.pagination.currentPage,limit:this.pagination.pageSize}}).then((function(t){console.log(t),e.data=t.list,e.pagination.total=t.total,e.loading=!1})).catch((function(t){console.log("err",t),e.loading=!1}))},searchList:function(){this.fetchData()},addBusiness:function(){this.addOrUpdateVisible=!0,this.dialogTitle="新增",this.form={businessLogo:""}},handleDialogCancel:function(e){this.$message({message:"取消保存",type:"warning"}),e()},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,s=e.size/1024/1024<2;return t||this.$message.error("只能上传jpg或png格式的图片!"),s||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&s},handleAvatarSuccess:function(e,t){200===e.code?(console.log(e.data),this.form.businessLogo=e.data):this.$message.error("上传失败："+e.desc)},saveOrUpdate:function(){var e=this;this.form.id?Object(i["c"])({businessId:this.form.id,businessName:this.form.businessName,businessLogo:this.form.businessLogo,businessAbout:this.form.businessAbout}).then((function(t){e.addOrUpdateVisible=!1,e.fetchData()})).catch((function(t){console.log("err",t),e.loading=!1})):(this.loading=!0,Object(i["a"])({businessName:this.form.businessName,businessLogo:this.form.businessLogo,businessAbout:this.form.businessAbout}).then((function(t){e.loading=!1,e.addOrUpdateVisible=!1,e.pagination.currentPage=1,e.fetchData()})).catch((function(t){console.log("err",t),e.loading=!1})))},showEditBusiness:function(e){var t=this,s=(e.index,e.row);this.addOrUpdateVisible=!0,this.dialogTitle="修改";var n=s.id;Object(i["d"])(n).then((function(e){console.log(e),t.form.id=e.id,t.form.businessName=e.businessName,t.form.businessLogo=e.logo,t.form.businessAbout=e.businessAbout})).catch((function(e){console.log("err",e),t.loading=!1}))},removeBusiness:function(e,t){var s=this,n=(e.index,e.row),o=n.id;Object(i["f"])(o).then((function(e){s.$message({message:"删除成功",type:"success"}),t()})).catch((function(e){console.log("err",e),s.loading=!1}))}}},l=u,c=(s("6966"),s("2877")),d=function(e){e.options.__source="src/views/business/list/businessList.vue"},m=d,f=Object(c["a"])(l,n,o,!1,null,null,null);"function"===typeof m&&m(f);t["default"]=f.exports},"2b6d":function(e,t,s){"use strict";s.d(t,"e",(function(){return i})),s.d(t,"a",(function(){return a})),s.d(t,"d",(function(){return r})),s.d(t,"c",(function(){return u})),s.d(t,"f",(function(){return l})),s.d(t,"b",(function(){return c}));var n=s("9bd2"),o=s("c276");function i(e){return Object(n["a"])({url:"/manager/business/business/list",method:"post",headers:{token:o["a"].cookies.get("token")},data:e})}function a(e){return Object(n["a"])({url:"/manager/business/business/add",method:"post",headers:{token:o["a"].cookies.get("token")},data:e})}function r(e){return Object(n["a"])({url:"/manager/business/business/info/"+e,method:"get",headers:{token:o["a"].cookies.get("token")}})}function u(e){return Object(n["a"])({url:"/manager/business/business/edit",method:"post",headers:{token:o["a"].cookies.get("token")},data:e})}function l(e){return Object(n["a"])({url:"/manager/business/business/remove/"+e,method:"post",headers:{token:o["a"].cookies.get("token")}})}function c(){return Object(n["a"])({url:"/manager/business/business/all",method:"get",headers:{token:o["a"].cookies.get("token")}})}},3395:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-image",{staticStyle:{width:"70px",height:"70px"},attrs:{src:e.scope.row.businessLogo}})},o=[],i={props:{value:{type:Boolean,require:!0},scope:{default:null},myProps:{default:null}},computed:{},mounted:function(){},methods:{}},a=i,r=s("2877"),u=function(e){e.options.__source="src/views/business/list/components/BusinessListImage.vue"},l=u,c=Object(r["a"])(a,n,o,!1,null,null,null);"function"===typeof l&&l(c);t["default"]=c.exports},6966:function(e,t,s){"use strict";var n=s("d57d"),o=s.n(n);o.a},d57d:function(e,t,s){}}]);